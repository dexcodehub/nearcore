%% NEARCore 工作区核心模块依赖关系图（Mermaid）
%% 说明：此图聚焦核心运行路径，工具与测试相关模块省略

flowchart LR
  %% 顶层二进制
  neard[neard 二进制] --> nearcore[nearcore 库]

  %% nearcore 依赖的核心组件
  nearcore --> client[near-client 客户端协调]
  nearcore --> chain[near-chain 区块/链状态]
  nearcore --> chunks[near-chunks 分片区块处理]
  nearcore --> network[near-network P2P网络]
  nearcore --> epoch[near-epoch-manager 选举/纪元]
  nearcore --> pool[near-pool 交易池]
  nearcore --> runtime[node-runtime 运行时]
  nearcore --> store[near-store 存储]
  nearcore --> primitives[near-primitives 类型与协议]
  nearcore --> params[near-parameters 协议参数]
  nearcore --> o11y[near-o11y 观测/日志]
  nearcore --> jsonrpc[near-jsonrpc RPC服务]
  nearcore --> rosetta[near-rosetta-rpc Rosetta API]

  %% 下层依赖
  client --> network
  client --> chain
  client --> pool
  client --> runtime
  client --> store
  client --> primitives
  client --> o11y

  chain --> epoch
  chain --> store
  chain --> primitives
  chain --> runtime
  chain --> network
  chain --> o11y
  chain --> params

  chunks --> chain
  chunks --> epoch
  chunks --> store
  chunks --> network
  chunks --> primitives

  runtime --> store
  runtime --> primitives
  runtime --> params
  runtime --> o11y

  jsonrpc --> client
  jsonrpc --> network
  rosetta --> client

  indexer[near-indexer 索引器] --> client
  indexer --> store

  %% 工具与外部
  tools[(tools/* 运维与分析工具)] --> nearcore

  %% 分组展示
  subgraph Node
    neard
    nearcore
  end

  subgraph Core
    client
    chain
    chunks
    epoch
    pool
    runtime
    store
    primitives
    params
    network
    o11y
  end

  subgraph API
    jsonrpc
    rosetta
  end

  subgraph Ecosystem
    indexer
    tools
  end